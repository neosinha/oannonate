<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: app.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: app.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
var ui = new Framework7UI();
var server = new SDomus();
var view = new AppView();
var deviceList = null; 
var deviceStatusList = null ; 

var deviceModel = function () { 
	this.mqttchannel= null ; 
	this.mqttchannelName= null ;
	this.status = null;
	this.lastmsg = null; 
} ;





/**
 * Function which accepts username, password from UI and fires off to the sever class after some validation
 * @function
 * @param username
 * @param password
 * @returns none
 */
function authProceed(username, password) {
	if ((username !== "") &amp; (password !== "")) {
		f7engine.closeModal();
		server.auth(username, password, authCallback);
	} else {
		view.appInit();
	}
}

function authCallback() {
	console.log(JSON.stringify(server.getUserModel()));
	accountid = server.getUserModel()['id']; 
	server.devicelist(accountid, deviceListCallback);
	
}


function deviceListCallback(response) {
	deviceList = JSON.parse(response); 
	console.log('DeviceList: '+ JSON.stringify(deviceList));
	view.createAppView();
}

/**
 * @function authCancel 
 * @param username
 * @param password
 * @returns none
 */
function authCancel(username, password) {
	view.appInit();
}

function appView() {
	ui.navbarTitle('Smart Domus');
	ui.navbarRight(); 
	
	btabs = Array(); 
	btabs.push({'icon': 'favorites', 'label' : 'Favor'});
	btabs.push({'icon': 'drawers', 'label' : 'Files'});
	btabs.push({'icon': 'home', 'label' : 'Home'});
	ui.bottomToolbar({'tabFunc': 'clickTester'}, btabs);
}



	
function testFunc(listId) {
	console.log('ListEl: '+listId + ' was clicked..');
}

function clickTester() {
	ui.alert({ 'text'  : "Click Tester",
		   'title' : "", 
		   'callback' : null});

}



setInterval (function() {
	 now = getEpoch(); 
	 for (x in deviceState) {
		 	devx = deviceState[x];
		 	delta = now - devx['lastmsg'];
		 ; 
		 if (delta > 10000) {
			 	devx['status'] = -1; 
		 }
		 updateButtonStatus();
	 }	
	}, 500) ;



</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Framework7UI.html">Framework7UI</a></li><li><a href="SDomus.html">SDomus</a></li></ul><h3>Global</h3><ul><li><a href="global.html#auth">auth</a></li><li><a href="global.html#authCancel">authCancel</a></li><li><a href="global.html#authProceed">authProceed</a></li><li><a href="global.html#devicelist">devicelist</a></li><li><a href="global.html#getUserModel">getUserModel</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.4</a> on Thu Aug 24 2017 05:18:07 GMT-0700 (PDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
